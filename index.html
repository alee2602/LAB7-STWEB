<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammy's Blog</title>
        <style>
            body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: #000000;
            }
            header {
                background-color: #EFB810;
                color: white;
                height: 100px;
                padding: 10px 0;
                text-align: center;
                font-size: 24px;
            }
            .banner {
                background: url('https://d34ugyblrhxy34.cloudfront.net/wp-content/uploads/2020/11/05230533/grammt.jpg') no-repeat center center;
                background-size: cover;
                height: 300px;
                width: 100%;
            }
            .container {
                width: 80%;
                margin: auto;
                overflow: hidden;
                padding-top: 20px;
            }
            .post {
                background: #fff;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 20px;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .postImage {
                max-width: 100%;
                border-radius: 8px;
            }
            .postTitle {
                margin-top: 0;
            }
            .loading {
                text-align: center;
                padding: 50px;
            }
            .error{
                color:red;
            }
        </style>
    </head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">

    // Components
    function Header(props) {
        return(
            <header>Grammy's Blog</header>
        )
    }
    
    function Banner(props) {
        return(
            <div className="banner"></div>
        )
    }

    function LoadingComponent(props){
        return(
            <div className="loading">Loading...</div>
        )
    }

    function Post({ post }) {
    return (
        <div className="post">
            <img src={post.image_url} alt={post.song_album_name} className="postImage" />
            <h2 className="postTitle">{post.title}</h2>
            <p>{post.content}</p>
            <p>Category: {post.category}</p>
            <p>Award Date: {new Date(post.award_date).toLocaleDateString()}</p>
        </div>
    );
}

    function App (props)  {
    const [posts, setPosts] = React.useState([]);
    const [loading, setLoading] = React.useState(true); //True mientras espera la obtenciÃ³n de datos
    const [error, setError] = React.useState(null); 

    // Obtener los posts de la api
    async function fetchPosts() {
        try{
            const response = await fetch('http://localhost:22249/posts');
            if (!response.ok){
                throw new Error(`Error! status: ${response.status}`);
            }
            const data = await response.json();
            setPosts(data);
            setLoading(false);
        } catch (error){
            console.error("Error fetching posts:", error);
            setError(error.message);
            setLoading(false);
        }
    }

    React.useEffect(() => {
        fetchPosts();
    }, []);

    return (
            <div>
                <Header />
                <Banner />
                {loading ? <LoadingComponent /> : error ? <div className="error">{error}</div> : (
                    <div className="container">
                        {posts.map(post => <Post key={post.id} post={post} />)}
                    </div>
                )}
            </div>
        );
    };

    ReactDOM.render(<App />, document.getElementById('root'));

    </script>
</body>
</html>